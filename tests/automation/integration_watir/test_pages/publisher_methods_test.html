<!DOCTYPE html>
<html>
	<head>
	<title>SafeFrame Publisher Methods Tests</title>
	<style type="text/css">

		BODY,HTML { 
			margin:0px; padding: 0px; line-height: 1.5em; 
			font-family: Arial;
		}
		
		h1{
			margin: 0 3px;
			font-size: 1.3em;
		}
		
		.floatRight{
			float: right;
		}
		.floatLeft{
			float: left;
		}
		
		.relative{
			position: relative;
		}
		
		.margin-rb{
			margin-right:10px;
			margin-bottom: 10px;
		}
		
		.contentSection{
			height: 500px;
			background: #efe;
			clear: both;
		}
		
		#header {
			height: 200px;
			overflow: hidden;
			position: relative;
		}
		
		#feedback
		{
			padding: 3px;
			position: absolute;
			right: 1px;
			top: 0;
			width: 360px;
			height: 100%;
			overflow: auto;
			border: 0;
			color: green;
			background: #333;
			text-align:left;
			display:inline-block;
		}
		
		.footer{
			clear: both;
			background: #eee;
			height: 350px;
		}


		iframe
		{
			border: 1px solid black;
			background: lightgreen;
		}
		</style>
	</head>
	<body>
			<div id="header" >
			<h1>SafeFrame Publisher Methods tests</h1>
			<div style="display:inline-block;">
			<button onclick="viewportDimensions()" id="viewportSizeBtn" type="button">Viewport Size</button>
			<button onclick="windowDimensions()" id="windowSizeBtn" type="button">Window Size</button> 
			<button onclick="clearHostLog()" id="clearLogBtn" type="button">Clear Host Log</button>
			<span id="dataOutput"></span>
			<br />
			<button onclick="checkInfo()" id="sfInfoBtn" type="button">Info</button> 
			<button onclick="nukePositions()" id="sfNukeBtn" type="button">Nuke</button> 
			<button onclick="getAd()" id="sfGetAdBtn" type="button">Get Ad</button> 
			<button onclick="renderAd('dynamAd', 'tgtLREC2', '<h1>Dynamic</h1> ad here' )" id="sfRenderAdBtn" type="button">Render Ad</button> 
			<button onclick="renderAd('fooDynamAd', 'foo', '<h1>Foo</h1> ad here' )" id="sfRenderAdBtn" type="button">Render Foo Ad</button> 
			
			</div>
			<div id="feedback_wrapper"><div id="feedback" ></div></div>

			</div>
			<div class="relative" style="clear:both;">
				<div class="floatLeft margin-rb" ><div id='tgtLREC2'></div></div>
				<p>
Vulputate leo phasellus turpis. Eros massa lorem tortor massa ipsum vestibulum, etiam tortor venenatis porta eu, est felis, lacus suspendisse mauris consectetuer ullamcorper elementum, massa mauris. Ac dolor ac enim modi nunc, vitae quis, dapibus in nonummy, ac dictum. Tempus varius curabitur ut, nulla imperdiet nibh vehicula. Risus amet donec sed, rutrum velit. Sollicitudin dolor sollicitudin dolor eget, dolor a dapibus pede maecenas pellentesque, velit nunc proin.
</p>
<p>
<div class="floatRight"><div id="foo"></div></div>
Sit adipiscing semper id in pellentesque, in sodales turpis, elit eu ullamcorper, ultrices suspendisse et, iaculis ac wisi arcu. Montes varius in velit consequat cras, volutpat taciti scelerisque amet. Eros imperdiet id, tempor in, porttitor magna eget sed cursus auctor eget, lorem sagittis, pellentesque wisi. Nulla neque urna sed risus, quis metus feugiat massa, sapien hendrerit dolor gravida porttitor donec cursus, pellentesque et, sodales tortor eget nec. Id sed sodales ipsum amet tristique, vitae lacus cursus in et. Vitae magna, blandit ut, in ut dui turpis pede urna lacus. Nibh purus. Reprehenderit ut posuere donec nibh vitae turpis, et odio. Ornare tortor, habitasse lectus consequat volutpat. Donec non. Justo et nunc sed id consequat.
				</p>				
					<script type='text/x-safeframe' class='sf_data'>
						{
							"id":		"ad2LREC",
							"html":	"<div style='background:#ccc;color:#000;height:100%;'><h1>Test Ad</h1></div>" ,

							"conf":
							{
								"w":		400,
								"h":		450,
								"dest":		"tgtLREC2"
							},
							"meta":
							{
								"context": "META-CONTENT initialized",
								"foometa": "you foo",
								"rmx":
								{
									"sectionID":	 "14800347",
									"siteID":		 "9999"

								}
							}
						}
					</script>
				</div>
			

			</div>
			
			<div class="contentSection">... more content here</div>

			<div class='footer'>
<p>
			Lorem ipsum dolor sit amet, scelerisque urna ut et ac quam. Purus odio et diam pellentesque ridiculus, hac libero, curabitur diam id facilisi eu. At ut. Integer cras vitae in duis, nibh neque ac etiam sed nonummy lacinia. Sollicitudin non tincidunt sed, nibh fermentum vel lacus. Velit proin vestibulum tristique sit, et natoque justo venenatis cras felis. Vel nam auctor nunc etiam, turpis viverra pede parturient ac lacus eros, curabitur eu, tristique orci, lacus elit in aliquam. Dapibus vivamus sed hymenaeos suspendisse, nisl lorem. Duis mi dictum nonummy, molestie phasellus est velit libero adipiscing proin. Metus sit orci sapien viverra, felis nibh sapien et ut, gravida tellus sit ornare. Malesuada risus sed non pharetra, sollicitudin amet egestas, cursus tortor. Fuga amet sodales ut quis, arcu massa tempor lacus.
			</p>
			<p>
Rhoncus venenatis nulla aenean libero pede ac, velit ac, feugiat elit massa praesent montes erat neque, ac wisi, nibh faucibus fringilla felis nihil. A fringilla voluptates, sit a lacinia elementum rutrum augue, aliquam rhoncus dignissim magna quisque eleifend phasellus, vel viverra velit duis vitae augue fringilla. Odio in viverra faucibus risus, non et velit sed massa, in diam, turpis felis, neque et nullam. Nisl elit. Vel nulla lorem cursus ac nulla, imperdiet nunc ut volutpat et. Id est aenean vivamus, eros at sapien sed, habitant laoreet, et enim accumsan, et lorem nunc. Sit enim vehicula ut pulvinar integer, ipsum curae ligula eu quam, vitae ad quis eget lectus, ullamcorper parturient eu congue nulla sed congue, pretium risus pharetra a. Wisi purus eget elit, in eleifend blandit, nec erat dui eget.
</p>
			</div>
			
		<!-- NOTE: For testing we are hosting in same domain. In production this should be a CDN on a different domain -->
		<script type="text/javascript" src="/src/js/lib/base.js"></script>
		<script type="text/javascript" src="/src/js/host/host.js"></script>
		<script type="text/javascript" src="/src/js/lib/boot.js"></script>
		<script type="text/javascript">

			var host = $sf.host;

			function nukePositions(){
				host.nuke();
			}
			
			function getAd(){
				var id = 'ad2LREC';
				var ad = host.get(id);
				var fb = document.getElementById("feedback");
				console.log(ad);
				if(ad == null){
					ad = 'null'
				}
				fb.innerHTML += "ad " + id + ": <br />" + ad.toString() + '<br/>';
			}
			
			
			function renderAd(adid, targetEl, content){
				var adConfig = {
				  id: adid, 
				  w: 350,
				  h: 400,
				  dest: targetEl
				};
				adConfig.supports = { 'exp-push' : true };
				// Register the ad position config information
				var posConf = new $sf.host.PosConfig(adConfig);

				// Create the ad position.
				var pos   = new $sf.host.Position(adid, content);

				// Render the ad in a SafeFrame.
				$sf.host.render(pos);
			}
			
			function startRenderCallback(id){
				var posConf = host.get(id);
				var fb = document.getElementById("feedback");
				fb.innerHTML += "onStartPosRender called for " + id + " <br />"
			}
			function endRenderCallback(id){
				var posConf = host.get(id);
				var fb = document.getElementById("feedback");
				fb.innerHTML += "onEndPosRender called for " + id + " <br />"
			}
			function beforePosMessageCallback(id, msgName, data){
				var posConf = host.get(id);
				var fb = document.getElementById("feedback");
				fb.innerHTML += "onBeforePosMsg called for " + id + " <br />"
			}
			function posMessageCallback(id, msgName, data){
				var posConf = host.get(id);
				var fb = document.getElementById("feedback");
				fb.innerHTML += "onPosMsg called for " + id + " with message: " + msgName + " <br />"
			}

			function renderFailCallback(id){
				var posConf = host.get(id);
				var fb = document.getElementById("feedback");
				fb.innerHTML += "onFailure called for " + id + " <br />"
			}

			function coverAd()
			{
				var el = document.getElementById("feedback");
				el.className = "coverAd";
				//var s = el.style;
				// s.position = "absolute";
				// s.right = "150px";
				// s.top = "230px";
			}

			function unCoverAd(){
				var el = document.getElementById("feedback");
				el.className = ""
				//s = el.style;
				//s.position = "inline";
			}
			
			function viewportDimensions(){
				var el = document.getElementById("dataOutput");
				var s;
				s = "w: " + window.innerWidth + ", h: " + window.innerHeight
				el.innerHTML = s;				
			}
			
			function windowDimensions(){
				var el = document.getElementById("dataOutput");
				var s;
				s = "w: " + window.outerWidth + ", h: " + window.outerHeight
				el.innerHTML = s;				
			}
			
			function clearHostLog(){
				document.getElementById("feedback").innerHTML = '';
			}
			
			function checkInfo(){
				var info = $sf.info;
				var el = document.getElementById("dataOutput");
				var fb = document.getElementById("feedback");
				fb.innerHTML += "$sf.info.list length: " + info.list.length + '<br/>'
				
				el.innerHTML = info.list.length;
			}



			/* render some sample content */
			(function() {
				var conf	= new $sf.host.Config({
					renderFile:		"/src/html/r.html",

 					onStartPosRender: startRenderCallback,
 					onFailure: renderFailCallback,
					onEndPosRender: endRenderCallback,
					onBeforePosMsg: beforePosMessageCallback,
					onPosMsg: posMessageCallback

				});


				// var posMeta		= new $sf.host.PosMeta(null,"rmx",{foo:"bar",bar:"foo"});
				// var pos			= new $sf.host.Position("LREC", "<h1>Hello World Sean</h1>", posMeta);

				// $sf.host.render(pos);
			})();
		</script>
	</body>
</html>